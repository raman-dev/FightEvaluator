<html>
    <head>
        <title>Hello World!</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
        <link rel="stylesheet" href="styles.css">
    </head>
    <body data-bs-theme="dark">
        <div class="border container-fluid">
            <!--
                
                |    fighter a  |     fighter b    |
                attrib 0     a.value 0   | b.value 0
                attrib 1     a.value 1   | b.value 1
                attrib 2     a.value 2   | b.value 2
                   .
                   .
                   .
                attrib n     a.value n  | b.value n
            -->
            <!--nine row table -->
            <table class="table">
                <thead class="border">
                    <tr class="border">
                        <th class="col">
                            <div>fighter a</div>
                            <div>fighter b</div>
                        </th>
                    </tr>   
                </thead> 
                <tbody>
                    <tr> 
                        <th>attrib 0</th>
                        <td>
                            <!-- a.value 0 -->
                            <div class="progress-bar" data-attrib-value="54">
                                <div class="bar">
                                </div>
                                <div class="value">54</div>
                            </div>
                            <div class="progress-bar" data-attrib-value="68" >
                                <div class="bar">
                                </div>
                                <div class="value">68</div>
                            </div>
                        </td>
                    </tr>
                    <tr> 
                        <th>attrib 0</th>
                        <td>
                            <!-- a.value 0 -->
                            <div class="progress-bar"  data-attrib-value="47">
                                <div class="bar">
                                </div>
                                <div class="value">54</div>
                            </div>
                            <div class="progress-bar" data-attrib-value="80" >
                                <div class="bar">
                                </div>
                                <div class="value">68</div>
                            </div>
                        </td>
                    </tr>
                    <tr> 
                        <th>attrib 0</th>
                        <td>
                            <!-- a.value 0 -->
                            <div class="progress-bar"  data-attrib-value="73">
                                <div class="bar">
                                </div>
                                <div class="value">54</div>
                            </div>
                            <div class="progress-bar" data-attrib-value="70" >
                                <div class="bar">
                                </div>
                                <div class="value">68</div>
                            </div>
                        </td>
                    </tr>
                    <tr> 
                        <th>attrib 0</th>
                        <td>
                            <!-- a.value 0 -->
                            <div class="progress-bar"  data-attrib-value="59">
                                <div class="bar">
                                </div>
                                <div class="value">54</div>
                            </div>
                            <div class="progress-bar" data-attrib-value="60" >
                                <div class="bar">
                                </div>
                                <div class="value">68</div>
                            </div>
                        </td>
                    </tr>
                    <tr> 
                        <th>attrib 0</th>
                        <td>
                            <!-- a.value 0 -->
                            <div class="progress-bar"  data-attrib-value="87">
                                <div class="bar">
                                </div>
                                <div class="value">54</div>
                            </div>
                            <div class="progress-bar" data-attrib-value="30" >
                                <div class="bar">
                                </div>
                                <div class="value">68</div>
                            </div>
                        </td>
                    </tr>
                </tbody>
               
            </table>
        </div>
        
        
        <style>
            /* table with is at most 40% of the screen */
            .table {
                max-width: 60%;
                margin: auto;
            }

            th {
                text-align: center;
                width: 12ch;
                white-space: nowrap;
            }

            .progress-bar {
                width: 100%;
                height: 20px;
                /* overflow: hidden; */
                background-color: #f2f2f2;
                color: black;
                position: relative;
            }
            
            .progress-bar .value{
                font-weight: bold;
                z-index: 2;
            }

            .bar {
                position: absolute;
                height: 100%;
                width: 0px;
                background-color: #007bff;
                z-index: 1;
            }
            
            /*
                for every tr td's even child's .bar should be red
            */
            .table tr td .progress-bar:first-child .bar {
                background-color: red;
            }

        </style>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
        <script>
            /*
            
                Promise takes a normal function as an argument
            */
        //    let normalFunction = () => {
        //      setTimeout(()=>{
        //         console.log('normal function');
        //      },2000);
        //    };
        //    //promises are executed immediately after instantiation
        //    let promise = new Promise((successHandler,errorHandler) => {
        //         console.log('promise ran!');
        //         normalFunction();
        //         successHandler(1);
        //         errorHandler(2);
        //    });
        //    //not necessary to all then at all 
        //    promise.then((val)=>{
        //      console.log(`called Resolve! => ${val}`);
        //    },(val)=>{
        //      console.log(`called Reject! => ${val}`);
        //    });
        // async function apiCall() {
        //     const response = await fetch("https://www.google.ca");
        //     // const json = await response.json();
        //     console.log(response.body);
        // }
        // apiCall();
        // Set the progress bar fill element
            
        // Set the progress bar animation
        

        //For every progress bar read the data-attribValue attribute and set the width of the progress bar fill element to that value
        const progressBars = document.querySelectorAll('.progress-bar');
      
        progressBars.forEach((progressBar,index) => {
            const progressFill = progressBar.querySelector('.bar');
            const progressText = progressBar.querySelector('.value');
            const attribValue = parseInt(progressBar.dataset.attribValue);

            let props = {
                barWidth: 0,
                barValue: 0
            }

            anime({
                targets: props,
                barWidth: `${attribValue}%}`,
                barValue: attribValue,
                easing: 'easeInOutQuad',
                delay: index * 100,
                update : (anim) => {
                    //set progressFill width to barWidth
                    progressFill.style.width = `${parseInt(props.barWidth)}%`;
                    progressText.textContent = `${parseInt(props.barValue)}`;
                    // console.log('updated' + `${props.barValue}`);
                },
                begin: (anim) => {
                    progressText.textContent = `${props.barValue}`;
                    console.log('began' + index);
                },
                duration: 500
            });
        });
        
        
        </script>
      
    </body>
</html>